<!DOCTYPE html>
<html lang="id" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Permainan Bahasa Arab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Naskh+Arabic:wght@400;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #F0F4F8;
        }
        .arabic {
            font-family: 'Noto Naskh Arabic', serif;
            font-size: 1.5rem;
            direction: rtl;
        }
        .game-card, .game-button {
            transition: all 0.3s ease;
        }
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        .draggable {
            touch-action: none;
            cursor: grab;
        }
        .drop-zone {
            transition: background-color 0.2s;
        }
        .drop-zone.over {
            background-color: #e0f2fe;
        }
        .feedback {
            transition: opacity 0.5s;
        }
        /* Memory Game Styles */
        .memory-card {
            perspective: 1000px;
        }
        .memory-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .memory-card.flipped .memory-card-inner, .memory-card.preview .memory-card-inner {
            transform: rotateY(180deg);
        }
        .memory-card-front, .memory-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
            text-align: center;
            padding: 4px;
        }
        .memory-card-front {
            background-color: #60a5fa; /* blue-400 */
        }
        .memory-card-back {
            background-color: #f0f9ff; /* blue-50 */
            transform: rotateY(180deg);
        }
        
        /* Style untuk Tic Tac Toe */
        .ttt-cell.filled { 
            cursor: not-allowed; 
        }
        .ttt-rtl { 
            direction: rtl; 
            font-family: 'Noto Naskh Arabic', serif;
        }

        /* Style untuk Game 12: Whack-a-Mole */
        .mole-hole {
            position: relative;
            overflow: hidden;
            background-color: #e5e7eb; /* gray-200 */
            border-radius: 1rem;
            box-shadow: inset 0 4px 6px rgba(0,0,0,0.1);
        }
        .mole {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #3b82f6; /* blue-500 */
            color: white;
            border-radius: 0.75rem;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            user-select: none;
        }
        .mole.up {
            transform: translateY(0);
        }
        .mole.hit {
            background-color: #22c55e; /* green-500 */
            transform: scale(0.95);
        }
        .mole.wrong {
            background-color: #ef4444; /* red-500 */
        }
    </style>
</head>
<body class="bg-blue-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-6xl">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-blue-800">Permainan Bahasa Arab</h1>
            <p class="text-gray-600 mt-2">(Berdasarkan Kitab Al-Arobiyyah Baina Yadai Aulaadina)</p>
        </header>

        <main>
            <!-- Menu Pilihan Game -->
            <section id="game-menu" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-6">
                <!-- Row 1 -->
                <div onclick="startGame('match-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-blue-500">
                    <h3 class="text-xl font-bold text-blue-800">1. Pasangkan Kata</h3>
                    <p class="mt-2 text-gray-600">Cocokkan kata Arab dengan artinya.</p>
                </div>
                <div onclick="startGame('find-letter-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-green-500">
                    <h3 class="text-xl font-bold text-green-800">2. Cari Huruf</h3>
                    <p class="mt-2 text-gray-600">Temukan huruf yang diminta di antara pilihan.</p>
                </div>
                <div onclick="startGame('arrange-letters-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-purple-500">
                    <h3 class="text-xl font-bold text-purple-800">3. Susun Kata</h3>
                    <p class="mt-2 text-gray-600">Susun kata acak menjadi satu kalimat bermakna.</p>
                </div>
                <!-- Row 2 -->
                <div onclick="startGame('true-false-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-red-500">
                    <h3 class="text-xl font-bold text-red-800">4. Benar atau Salah</h3>
                    <p class="mt-2 text-gray-600">Tentukan apakah arti kata yang ditampilkan benar.</p>
                </div>
                <div onclick="startGame('guess-word-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-yellow-500">
                    <h3 class="text-xl font-bold text-yellow-800">5. Tebak Kata</h3>
                    <p class="mt-2 text-gray-600">Lengkapi kalimat percakapan yang rumpang.</p>
                </div>
                <div onclick="startGame('memory-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-indigo-500">
                    <h3 class="text-xl font-bold text-indigo-800">6. Memori Huruf</h3>
                    <p class="mt-2 text-gray-600">Cari pasangan huruf yang sama setelah menghafal.</p>
                </div>
                <!-- Row 3 -->
                <div onclick="startGame('greeting-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-cyan-500">
                    <h3 class="text-xl font-bold text-cyan-800">7. Pilih Sapaan Tepat</h3>
                    <p class="mt-2 text-gray-600">Pilih sapaan yang sesuai dengan situasi.</p>
                </div>
                <div onclick="startGame('logical-pairs-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-orange-500">
                    <h3 class="text-xl font-bold text-orange-800">8. Sambungkan Kalimat</h3>
                    <p class="mt-2 text-gray-600">Hubungkan pertanyaan dengan jawaban yang tepat.</p>
                </div>
                <div onclick="startGame('memory-word-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-pink-500">
                    <h3 class="text-xl font-bold text-pink-800">9. Memori Kata</h3>
                    <p class="mt-2 text-gray-600">Cocokkan kata dan artinya setelah menghafal.</p>
                </div>
                <!-- Row 4 -->
                 <div onclick="startGame('tic-tac-toe-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-teal-500">
                    <h3 class="text-xl font-bold text-teal-800">10. Tic Tac Toe Kosa Kata</h3>
                    <p class="mt-2 text-gray-600">Jawab soal kosa kata untuk menempatkan tandamu.</p>
                </div>
                <div onclick="startGame('group-guess-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-lime-500">
                    <h3 class="text-xl font-bold text-lime-800">11. Tebak Kata Berkelompok</h3>
                    <p class="mt-2 text-gray-600">Bermain tebak kata secara berkelompok!</p>
                </div>
                <!-- (BARU) Game 12 -->
                <div onclick="startGame('whack-a-mole-game')" class="game-card bg-white p-6 rounded-xl shadow-md cursor-pointer border-l-8 border-rose-500">
                    <h3 class="text-xl font-bold text-rose-800">12. Pukul Kata (Refleks)</h3>
                    <p class="mt-2 text-gray-600">Pukul kata Arab yang benar sebelum menghilang!</p>
                </div>
            </section>
            
            <!-- Container untuk Game yang aktif -->
            <section id="game-container" class="mt-8 hidden"></section>
        </main>
    </div>

    <!-- Modal untuk Tic Tac Toe (di luar container utama) -->
    <div id="ttt-question-modal" class="fixed inset-0 bg-black bg-opacity-60 items-center justify-center p-4 backdrop-blur-sm z-50" style="display: none;">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full" id="ttt-question-box">
            <h2 class="text-xl font-semibold text-center text-gray-700 mb-2">Apa arti dari kata ini?</h2>
            <h3 id="ttt-vocab-word" class="text-5xl font-bold text-center text-gray-900 my-6 ttt-rtl">
                <!-- Kata TTT diisi JS -->
            </h3>
            <div id="ttt-options-container" class="flex flex-col space-y-3">
                <!-- Pilihan TTT diisi JS -->
            </div>
            <div id="ttt-timer-display" class="text-2xl font-bold text-center text-red-500 my-4 h-8">
                <!-- Timer TTT diisi JS -->
            </div>
            <p id="ttt-result-message" class="text-center font-semibold mt-4 h-6">
                <!-- Pesan TTT diisi JS -->
            </p>
        </div>
    </div>


    <script>
        // --- DATA UNTUK GAMES ---
        const matchData = { "Nama saya": "اسْمِي", "Nama kamu (pr)": "اسْمُكِ", "Saya": "أَنَا", "Kamu (lk)": "أَنْتَ", "Selamat tinggal": "مَعَ السَّلَامَةِ", "Apa kabarmu? (lk)": "كَيْفَ حَالُكَ؟" };
        const findLetterPool = ['ت', 'ط', 'خ', 'ك', 'د', 'ذ', 'ر', 'ز', 'س', 'ش', 'ص', 'ض', 'أ', 'ب', 'ث'];
        const arrangeWordData = [
            { word: "خَدِيجَةُ", components: ["خَ", "دِي", "جَ", "ةُ"] },
            { word: "السَّلَامُ", components: ["ال", "سَّ", "لَا", "مُ"] },
            { word: "عَلَيْكُمْ", components: ["عَ", "لَيْ", "كُمْ"] }
        ];
        const trueFalseData = [
            { word: "مَا اسْمُكِ؟", meaning: "Siapa namamu (lk)?", correct: false },
            { word: "أَنَا بِخَيْرٍ", meaning: "Saya baik-baik saja", correct: true },
            { word: "أَنْتِ", meaning: "Kamu (pr)", correct: true },
            { word: "السَّلَامُ", meaning: "Sampai Jumpa", correct: false }
        ];
        const guessWordData = [
            { sentence: ["السَّلَامُ", "______"], options: ["عَلَيْكُمْ", "بِخَيْرٍ", "اسْمُكِ"], answer: "عَلَيْكُمْ" },
            { sentence: ["مَا", "______؟"], options: ["أَنَا", "اسْمُكَ", "خَوْلَةُ"], answer: "اسْمُكَ" },
            { sentence: ["أَنَا", "______"], options: ["حَالُكَ", "بِخَيْرٍ", "مَعَ"], answer: "بِخَيْرٍ" }
        ];
        const memoryGameLetters = ['أ', 'ب', 'ت', 'ث', 'ج', 'ح'];
        const memoryWordData = [ 
            { arabic: 'اسْمِي', indo: 'Nama saya' }, 
            { arabic: 'أَنَا', indo: 'Saya' }, 
            { arabic: 'أَنْتَ', indo: 'Kamu (lk)' }, 
            { arabic: 'بِخَيْرٍ', indo: 'Baik-baik' },
            { arabic: 'اسْمُكِ', indo: 'Namamu (pr)' },
            { arabic: 'أَنْتِ', indo: 'Kamu (pr)' },
            { arabic: 'السَّلَامُ', indo: 'Keselamatan' },
            { arabic: 'عَلَيْكُمْ', indo: 'Atas kalian' }
        ];
        const greetingGameData = [
            { situation: "Saat dua orang bertemu untuk pertama kali:", options: ["السَّلَامُ عَلَيْكُمْ", "مَعَ السَّلَامَةِ", "أَنَا بِخَيْرٍ"], answer: "السَّلَامُ عَلَيْكُمْ" },
            { situation: "Saat seseorang menjawab sapaan salam:", options: ["كَيْفَ حَالُكَ؟", "وَعَلَيْكُمُ السَّلَامُ", "اسْمِي"], answer: "وَعَلَيْكُمُ السَّلَامُ" },
        ];
        const logicalPairsData = { "السَّلَامُ عَلَيْكُمْ": "وَعَلَيْكُمُ السَّلَامُ", "مَا اسْمُكِ؟": "اسْمِي خَدِيجَةُ", "كَيْفَ حَالُكَ؟": "أَنَا بِخَيْرٍ" };

        // Data untuk Tic Tac Toe
        const ticTacToeData = [
            { word: "أَنَا", options: ["Saya", "Kamu (lk)", "Dia (pr)"], correct: 0 },
            { word: "قَلَمُ", options: ["Mobil", "Pena", "Tas"], correct: 1 },
            { word: "اسْمِي", options: ["Namamu (pr)", "Nama saya", "Namamu (lk)"], correct: 1 },
            { word: "نَعَمْ", options: ["Ya", "Tidak", "Di mana"], correct: 0 },
            { word: "لَا", options: ["Berapa", "Ya", "Tidak"], correct: 2 },
            { word: "أَيْنَ", options: ["Di sini", "Di mana", "Banyak"], correct: 1 },
            { word: "هُنَا", options: ["Di sini", "Di sana", "Pena"], correct: 0 },
            { word: "وَاحِدٌ", options: ["Tiga", "Satu", "Dua"], correct: 1 },
            { word: "اثْنَانِ", options: ["Dua", "Empat", "Satu"], correct: 0 },
            { word: "ثَلَاثَةٌ", options: ["Lima", "Tiga", "Empat"], correct: 1 },
            { word: "حَقِيبَةٌ", options: ["Kertas", "Mobil", "Tas"], correct: 2 },
            { word: "سَيَّارَةٌ", options: ["Mobil", "Tas", "Sedikit"], correct: 0 },
            { word: "كَثِيرٌ", options: ["Sedikit", "Berapa", "Banyak"], correct: 2 },
            { word: "قَلِيلٌ", options: ["Sedikit", "Banyak", "Mobil"], correct: 0 },
            { word: "كَمْ", options: ["Di mana", "Berapa", "Tidak"], correct: 1 },
            { word: "وَرَقَةٌ", options: ["Kertas", "Pena", "Satu"], correct: 0 },
            { word: "أَنْتَ", options: ["Saya", "Kamu (lk)", "Kamu (pr)"], correct: 1 },
            { word: "أَنْتِ", options: ["Kamu (pr)", "Dia (lk)", "Saya"], correct: 0 },
            { word: "اسْمُكَ", options: ["Namamu (lk)", "Nama saya", "Namamu (pr)"], correct: 0 },
            { word: "اسْمُكِ", options: ["Nama saya", "Namamu (lk)", "Namamu (pr)"], correct: 2 }
        ];

        // Data untuk Game 11: Tebak Kata Berkelompok & Game 12: Pukul Kata (Shared Data)
        const guessGroupData = [
            { word: "قَلَمُ", meaning: "Pena" },
            { word: "حَقِيبَةٌ", meaning: "Tas" },
            { word: "سَيَّارَةٌ", meaning: "Mobil" },
            { word: "وَاحِدٌ", meaning: "Satu" },
            { word: "كَثِيرٌ", meaning: "Banyak" },
            { word: "قَلِيلٌ", meaning: "Sedikit" },
            { word: "أَنَا", meaning: "Saya" },
            { word: "اسْمِي", meaning: "Nama saya" },
            { word: "أَنْتَ", meaning: "Kamu (lk)" },
            { word: "أَنْتِ", meaning: "Kamu (pr)" },
            { word: "نَعَمْ", meaning: "Ya" },
            { word: "لَا", meaning: "Tidak" },
            { word: "كَمْ", meaning: "Berapa" },
            { word: "أَيْنَ", meaning: "Di mana" },
            { word: "هُنَا", meaning: "Di sini" },
            { word: "وَرَقَةٌ", meaning: "Kertas" }
        ];

        // Variabel Global Game 11
        let groupGameScores = { timA: 0, timB: 0 };
        let currentRound = 1;
        let currentTurn = 'timA';
        let groupGameTimer = null;
        let groupGameShuffledDeck = [];

        // (BARU) Variabel Global Game 12
        let wamScore = 0;
        let wamTimeLeft = 30;
        let wamTimer = null;
        let wamMoleTimer = null;
        let wamTarget = null;
        let wamIsPlaying = false;
        let lastHole;

        // --- FUNGSI UTAMA ---
        function startGame(gameId) {
            document.getElementById('game-menu').classList.add('hidden');
            const container = document.getElementById('game-container');
            container.classList.remove('hidden');
            container.innerHTML = `
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <div id="game-content"></div>
                    <button onclick="showMenu()" class="mt-6 bg-gray-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-600 transition-colors"> Kembali ke Menu</button>
                </div>`;
            
            const gameContent = document.getElementById('game-content');
            
            const gameFunctions = {
                'match-game': setupMatchGame,
                'find-letter-game': setupFindLetterGame,
                'arrange-letters-game': setupArrangeLettersGame,
                'true-false-game': setupTrueFalseGame,
                'guess-word-game': setupGuessWordGame,
                'memory-game': setupMemoryGame,
                'greeting-game': setupGreetingGame,
                'logical-pairs-game': setupLogicalPairsGame,
                'memory-word-game': setupMemoryWordGame,
                'tic-tac-toe-game': setupTicTacToeGame, 
                'group-guess-game': setupGroupGuessGame,
                'whack-a-mole-game': setupWhackAMoleGame // (BARU) Game 12
            };
            if (gameFunctions[gameId]) {
                gameFunctions[gameId](gameContent);
            }
        }

        // Objek untuk menampung logika & status Tic Tac Toe
        let tttGameLogic = {
            player: 'X',
            board: Array(9).fill(''),
            active: true,
            targetIndex: null,
            questions: [],
            timer: null,
            dom: {}
        };

        function showMenu() {
            document.getElementById('game-container').classList.add('hidden');
            document.getElementById('game-menu').classList.remove('hidden');

            // Cleanup untuk Tic Tac Toe
            const tttModal = document.getElementById('ttt-question-modal');
            if (tttModal) tttModal.style.display = 'none';
            if (tttGameLogic.timer) clearInterval(tttGameLogic.timer);
            tttGameLogic = { ...tttGameLogic, active: false, timer: null, dom: {} };

            // Cleanup untuk Game 11
            if (groupGameTimer) clearInterval(groupGameTimer);
            groupGameScores = { timA: 0, timB: 0 };
            currentRound = 1;
            currentTurn = 'timA';
            groupGameShuffledDeck = [];

            // (BARU) Cleanup untuk Game 12
            stopWhackAMoleGame();
        }
        
        // ... (Fungsi Game 1 - 11 sama seperti sebelumnya) ...
        function setupMatchGame(container) { 
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-blue-800 mb-4">Pasangkan Kata!</h3>
                <div class="flex flex-col md:flex-row justify-between items-start gap-4">
                    <div id="indonesian-words" class="w-full md:w-1/2 flex flex-col gap-3"></div>
                    <div id="arabic-words" class="w-full md:w-1/2 flex flex-col gap-3"></div>
                </div>
                <p id="feedback" class="feedback text-center font-bold mt-4 h-6"></p>`;
            
            let selectedIndo = null, selectedArabic = null, matchedPairs = 0;
            const feedbackEl = container.querySelector('#feedback');
            const indoContainer = container.querySelector('#indonesian-words');
            const arabicContainer = container.querySelector('#arabic-words');

            const indoWords = Object.keys(matchData);
            const arabicWords = Object.values(matchData).sort(() => Math.random() - 0.5);

            indoWords.forEach(word => {
                const btn = document.createElement('button');
                btn.innerText = word;
                btn.dataset.word = word;
                btn.className = 'game-button w-full p-3 bg-blue-100 rounded-lg text-blue-800 font-semibold border-2 border-transparent';
                btn.onclick = () => {
                    if (selectedIndo) selectedIndo.classList.remove('ring-4', 'ring-blue-400');
                    selectedIndo = btn;
                    selectedIndo.classList.add('ring-4', 'ring-blue-400');
                    checkMatch();
                };
                indoContainer.appendChild(btn);
            });

            arabicWords.forEach(word => {
                const btn = document.createElement('button');
                btn.innerText = word;
                btn.dataset.word = word;
                btn.className = 'game-button w-full p-3 bg-green-100 rounded-lg text-green-800 font-semibold arabic border-2 border-transparent';
                btn.onclick = () => {
                    if (selectedArabic) selectedArabic.classList.remove('ring-4', 'ring-green-400');
                    selectedArabic = btn;
                    selectedArabic.classList.add('ring-4', 'ring-green-400');
                    checkMatch();
                };
                arabicContainer.appendChild(btn);
            });

            function checkMatch() {
                if (selectedIndo && selectedArabic) {
                    if (matchData[selectedIndo.dataset.word] === selectedArabic.dataset.word) {
                        feedbackEl.textContent = 'Benar! (صَحِيحٌ)';
                        feedbackEl.style.color = '#16A34A';
                        selectedIndo.style.visibility = 'hidden';
                        selectedArabic.style.visibility = 'hidden';
                        matchedPairs++;
                        if(matchedPairs === indoWords.length) {
                           feedbackEl.textContent = 'Hebat! Semua terpasang!';
                        }
                    } else {
                        feedbackEl.textContent = 'Kurang tepat!';
                        feedbackEl.style.color = '#DC2626';
                    }
                    setTimeout(() => {
                        if (selectedIndo) selectedIndo.classList.remove('ring-4', 'ring-blue-400');
                        if (selectedArabic) selectedArabic.classList.remove('ring-4', 'ring-green-400');
                        selectedIndo = selectedArabic = null;
                        if(feedbackEl.textContent === 'Kurang tepat!') feedbackEl.textContent = '';
                    }, 1000);
                }
            }
        }
        function setupFindLetterGame(container) { 
             container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-green-800 mb-2">Cari Huruf!</h3>
                <p class="text-center mb-4">Klik pada huruf <span id="target-letter" class="arabic text-3xl font-bold"></span></p>
                <div id="letter-grid" class="grid grid-cols-4 sm:grid-cols-5 gap-3 my-4 max-w-md mx-auto"></div>
                <p id="feedback" class="feedback text-center font-semibold h-6"></p>`;
            
            const grid = container.querySelector('#letter-grid');
            const targetEl = container.querySelector('#target-letter');
            const feedbackEl = container.querySelector('#feedback');

            function nextRound() {
                feedbackEl.textContent = '';
                const targetLetter = findLetterPool[Math.floor(Math.random() * findLetterPool.length)];
                targetEl.textContent = targetLetter;

                let options = [targetLetter];
                while(options.length < 10) {
                    const random = findLetterPool[Math.floor(Math.random() * findLetterPool.length)];
                    if(!options.includes(random)) options.push(random);
                }
                options.sort(() => Math.random() - 0.5);

                grid.innerHTML = '';
                options.forEach(letter => {
                    const btn = document.createElement('button');
                    btn.textContent = letter;
                    btn.className = 'game-button arabic text-4xl p-4 bg-gray-100 rounded-lg hover:bg-gray-200';
                    btn.onclick = () => {
                        if(letter === targetLetter) {
                            feedbackEl.textContent = 'Benar! (أحسنت)';
                            feedbackEl.style.color = '#16A34A';
                            setTimeout(nextRound, 1000);
                        } else {
                            feedbackEl.textContent = 'Salah!';
                            feedbackEl.style.color = '#DC2626';
                        }
                    };
                    grid.appendChild(btn);
                });
            }
            nextRound();
        }
        function setupTrueFalseGame(container, questionIndex = 0) {
            const item = trueFalseData[questionIndex];
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-red-800 mb-4">Benar atau Salah?</h3>
                <div class="bg-gray-100 rounded-lg p-6 text-center">
                    <p class="arabic text-4xl">${item.word}</p>
                    <p class="text-xl mt-2">Artinya: "${item.meaning}"</p>
                </div>
                <div class="flex justify-center gap-4 mt-6">
                    <button id="true-btn" class="game-button w-32 text-lg bg-green-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-600">Benar</button>
                    <button id="false-btn" class="game-button w-32 text-lg bg-red-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-red-600">Salah</button>
                </div>
                <p id="feedback" class="feedback text-center font-semibold h-6 mt-4"></p>`;

            const feedbackEl = container.querySelector('#feedback');
            container.querySelector('#true-btn').onclick = () => checkAnswer(true);
            container.querySelector('#false-btn').onclick = () => checkAnswer(false);

            function checkAnswer(userAnswer) {
                if (userAnswer === item.correct) {
                    feedbackEl.textContent = 'Jawabanmu Benar!';
                    feedbackEl.style.color = '#16A34A';
                } else {
                    feedbackEl.textContent = 'Jawabanmu Salah!';
                    feedbackEl.style.color = '#DC2626';
                }
                setTimeout(() => setupTrueFalseGame(container, (questionIndex + 1) % trueFalseData.length), 1500);
            }
        }
        function setupGuessWordGame(container, questionIndex = 0) {
            const item = guessWordData[questionIndex];
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-yellow-800 mb-4">Lengkapi Kalimat!</h3>
                <div class="arabic text-4xl text-center bg-gray-100 p-6 rounded-lg">
                    ${item.sentence.join(' ')}
                </div>
                <div id="options" class="grid grid-cols-3 gap-4 mt-6"></div>
                <p id="feedback" class="feedback text-center font-semibold h-6 mt-4"></p>`;

            const optionsContainer = container.querySelector('#options');
            const feedbackEl = container.querySelector('#feedback');
            const shuffledOptions = [...item.options].sort(() => Math.random() - 0.5);
            
            shuffledOptions.forEach(opt => {
                const btn = document.createElement('button');
                btn.textContent = opt;
                btn.className = 'game-button arabic text-2xl p-4 bg-yellow-100 rounded-lg hover:bg-yellow-200';
                btn.onclick = () => {
                    if (opt === item.answer) {
                        feedbackEl.textContent = 'Sempurna!';
                        feedbackEl.style.color = '#16A34A';
                    } else {
                        feedbackEl.textContent = 'Bukan yang itu!';
                        feedbackEl.style.color = '#DC2626';
                    }
                    setTimeout(() => setupGuessWordGame(container, (questionIndex + 1) % guessWordData.length), 1500);
                }
                optionsContainer.appendChild(btn);
            });
        }
        function setupGreetingGame(container, questionIndex = 0) {
             const item = greetingGameData[questionIndex];
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-cyan-800 mb-4">Pilih Sapaan Tepat</h3>
                <p class="text-center text-lg mb-4">${item.situation}</p>
                <div id="options" class="flex flex-col gap-3 max-w-md mx-auto"></div>
                <p id="feedback" class="feedback text-center font-semibold h-6 mt-4"></p>`;

            const optionsContainer = container.querySelector('#options');
            const feedbackEl = container.querySelector('#feedback');
            
            item.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.textContent = opt;
                btn.className = 'game-button arabic text-2xl p-4 bg-cyan-100 rounded-lg hover:bg-cyan-200';
                btn.onclick = () => {
                    if (opt === item.answer) {
                        feedbackEl.textContent = 'Tepat!';
                        feedbackEl.style.color = '#0e7490';
                    } else {
                        feedbackEl.textContent = 'Kurang sesuai.';
                        feedbackEl.style.color = '#DC2626';
                    }
                    setTimeout(() => setupGreetingGame(container, (questionIndex + 1) % greetingGameData.length), 1500);
                }
                optionsContainer.appendChild(btn);
            });
        }
        function setupLogicalPairsGame(container) {
             container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-orange-800 mb-4">Sambungkan Kalimat</h3>
                <p class="text-center mb-4">Hubungkan pertanyaan di kiri dengan jawaban yang tepat di kanan.</p>
                <div class="flex flex-col md:flex-row justify-between items-start gap-4">
                    <div id="questions" class="w-full md:w-1/2 flex flex-col gap-3"></div>
                    <div id="answers" class="w-full md:w-1/2 flex flex-col gap-3"></div>
                </div>
                <p id="feedback" class="feedback text-center font-bold mt-4 h-6"></p>`;
            
            let selectedQ = null, selectedA = null, matched = 0;
            const feedbackEl = container.querySelector('#feedback');
            const qContainer = container.querySelector('#questions');
            const aContainer = container.querySelector('#answers');

            const questions = Object.keys(logicalPairsData);
            const answers = Object.values(logicalPairsData).sort(() => Math.random() - 0.5);

            questions.forEach(q => {
                const btn = document.createElement('button');
                btn.textContent = q;
                btn.dataset.word = q;
                btn.className = 'game-button arabic w-full p-3 bg-orange-100 rounded-lg text-orange-800 font-semibold';
                btn.onclick = () => {
                    if(selectedQ) selectedQ.classList.remove('ring-4', 'ring-orange-400');
                    selectedQ = btn;
                    selectedQ.classList.add('ring-4', 'ring-orange-400');
                    checkPair();
                };
                qContainer.appendChild(btn);
            });

            answers.forEach(a => {
                const btn = document.createElement('button');
                btn.textContent = a;
                btn.dataset.word = a;
                btn.className = 'game-button arabic w-full p-3 bg-amber-100 rounded-lg text-amber-800 font-semibold';
                 btn.onclick = () => {
                    if(selectedA) selectedA.classList.remove('ring-4', 'ring-amber-400');
                    selectedA = btn;
                    selectedA.classList.add('ring-4', 'ring-amber-400');
                    checkPair();
                };
                aContainer.appendChild(btn);
            });

            function checkPair() {
                if (selectedQ && selectedA) {
                    if (logicalPairsData[selectedQ.dataset.word] === selectedA.dataset.word) {
                        feedbackEl.textContent = 'Pasangan yang tepat!';
                        feedbackEl.style.color = '#9a3412';
                        selectedQ.style.visibility = 'hidden';
                        selectedA.style.visibility = 'hidden';
                        matched++;
                        if (matched === questions.length) feedbackEl.textContent = 'Semua berhasil dipasangkan!';
                    } else {
                        feedbackEl.textContent = 'Bukan pasangan yang cocok!';
                        feedbackEl.style.color = '#DC2626';
                    }
                    setTimeout(() => {
                        if (selectedQ) selectedQ.classList.remove('ring-4', 'ring-orange-400');
                        if (selectedA) selectedA.classList.remove('ring-4', 'ring-amber-400');
                        selectedQ = selectedA = null;
                        if(feedbackEl.textContent === 'Bukan pasangan yang cocok!') feedbackEl.textContent = '';
                    }, 1000);
                }
            }
        }
        function setupArrangeLettersGame(container, wordIndex = 0) { // REVISED
            const item = arrangeWordData[wordIndex];
            const word = item.word;
            const shuffledComponents = [...item.components].sort(() => Math.random() - 0.5);
            
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-purple-800 mb-2">Susun Kata!</h3>
                <p class="text-center mb-4">Seret & lepas komponen untuk membentuk kata yang tersambung.</p>
                <div id="drop-zone" class="drop-zone arabic text-5xl flex justify-center items-center bg-gray-100 p-4 h-28 rounded-lg border-2 border-dashed"></div>
                <div id="letter-source" class="arabic flex justify-center items-center gap-3 mt-4 flex-wrap"></div>
                <p id="feedback" class="feedback text-center font-semibold h-6 mt-4"></p>`;

            const source = container.querySelector('#letter-source');
            const dropZone = container.querySelector('#drop-zone');
            const feedbackEl = container.querySelector('#feedback');

            shuffledComponents.forEach((comp, index) => {
                const el = document.createElement('div');
                el.textContent = comp;
                el.id = `drag-${index}`;
                el.className = 'draggable text-4xl p-3 bg-purple-200 rounded-lg shadow';
                el.draggable = true;
                el.addEventListener('dragstart', e => e.dataTransfer.setData('text/id', e.target.id));
                source.appendChild(el);
            });
            
            dropZone.addEventListener('dragover', e => { e.preventDefault(); dropZone.classList.add('over'); });
            dropZone.addEventListener('dragleave', () => dropZone.classList.remove('over'));
            dropZone.addEventListener('drop', e => {
                e.preventDefault();
                dropZone.classList.remove('over');
                const id = e.dataTransfer.getData('text/id');
                const draggedEl = source.querySelector(`#${id}`);
                if(draggedEl && draggedEl.style.visibility !== 'hidden') {
                    dropZone.textContent += draggedEl.textContent; // Append text for connection
                    draggedEl.style.visibility = 'hidden';
                    checkAnswer();
                }
            });

            function checkAnswer() {
                const currentAnswer = dropZone.textContent;
                if (source.querySelectorAll('[style="visibility: hidden;"]').length === item.components.length) {
                    if (currentAnswer === word) {
                        feedbackEl.textContent = 'Tepat sekali!';
                        feedbackEl.style.color = '#16A34A';
                        setTimeout(() => setupArrangeLettersGame(container, (wordIndex + 1) % arrangeWordData.length), 1500);
                    } else {
                        feedbackEl.textContent = 'Belum benar, coba lagi!';
                        feedbackEl.style.color = '#DC2626';
                        setTimeout(() => setupArrangeLettersGame(container, wordIndex), 1500);
                    }
                }
            }
        }
        function setupMemoryGame(container) { // REVISED
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-indigo-800 mb-2">Memori Huruf</h3>
                <p id="instruction" class="text-center text-lg mb-4">Hafalkan posisi huruf selama 7 detik!</p>
                <div id="memory-board" class="grid grid-cols-4 gap-4 max-w-md mx-auto"></div>
                <p id="feedback" class="feedback text-center font-semibold h-6 mt-4"></p>`;

            const board = container.querySelector('#memory-board');
            const feedbackEl = container.querySelector('#feedback');
            const instructionEl = container.querySelector('#instruction');
            const cardsData = [...memoryGameLetters, ...memoryGameLetters].sort(() => 0.7 - Math.random());
            let flippedCards = [];
            let matchedPairs = 0;
            let canClick = false;

            cardsData.forEach(letter => {
                const card = document.createElement('div');
                card.className = 'memory-card h-24';
                card.dataset.letter = letter;
                card.innerHTML = `
                    <div class="memory-card-inner">
                        <div class="memory-card-front"></div>
                        <div class="memory-card-back"><span class="arabic text-4xl text-indigo-800">${letter}</span></div>
                    </div>`;
                card.addEventListener('click', () => handleCardClick(card));
                board.appendChild(card);
            });

            // Preview Phase
            const allCards = board.querySelectorAll('.memory-card');
            allCards.forEach(c => c.classList.add('preview'));
            setTimeout(() => {
                allCards.forEach(c => c.classList.remove('preview'));
                canClick = true;
                instructionEl.textContent = "Cari pasangan huruf yang sama!";
            }, 5000); // 5 detik

            function handleCardClick(card) {
                if (!canClick || flippedCards.length >= 2 || card.classList.contains('flipped')) {
                    return;
                }
                card.classList.add('flipped');
                flippedCards.push(card);
                if (flippedCards.length === 2) {
                    checkMemoryMatch();
                }
            }

            function checkMemoryMatch() {
                const [card1, card2] = flippedCards;
                if (card1.dataset.letter === card2.dataset.letter) {
                    feedbackEl.textContent = 'Cocok!';
                    feedbackEl.style.color = '#4f46e5';
                    matchedPairs++;
                    flippedCards = [];
                    if (matchedPairs === memoryGameLetters.length) {
                        feedbackEl.textContent = 'Semua pasangan ditemukan!';
                    }
                } else {
                    feedbackEl.textContent = 'Coba lagi!';
                    feedbackEl.style.color = '#DC2626';
                    setTimeout(() => {
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        flippedCards = [];
                        feedbackEl.textContent = '';
                    }, 1200);
                }
            }
        }
        function setupMemoryWordGame(container) { // REVISED & EXPANDED
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-pink-800 mb-2">Memori Kata</h3>
                <p id="instruction" class="text-center text-lg mb-4">Hafalkan pasangan kata selama 7 detik!</p>
                <div id="memory-board" class="grid grid-cols-4 gap-4 max-w-2xl mx-auto"></div>
                <p id="feedback" class="feedback text-center font-semibold h-6 mt-4"></p>`;
            
            const board = container.querySelector('#memory-board');
            const feedbackEl = container.querySelector('#feedback');
            const instructionEl = container.querySelector('#instruction');
            let flippedCards = [];
            let matchedPairs = 0;
            let canClick = false;

            const pairs = memoryWordData; // Use all 8 pairs
            const cardsContent = [];
            pairs.forEach((p, index) => {
              cardsContent.push({ content: p.arabic, pairId: index, type: 'arabic' });
              cardsContent.push({ content: p.indo, pairId: index, type: 'indo' });
            });
            cardsContent.sort(() => 0.7 - Math.random());

            cardsContent.forEach(item => {
                const card = document.createElement('div');
                card.className = 'memory-card h-28 cursor-pointer';
                card.dataset.pairId = item.pairId;
                const isArabic = item.type === 'arabic';
                card.innerHTML = `
                    <div class="memory-card-inner">
                        <div class="memory-card-front"></div>
                        <div class="memory-card-back">
                            <span class="${isArabic ? 'arabic text-2xl' : 'text-lg'} ${isArabic ? 'text-pink-800' : 'text-gray-700'}">${item.content}</span>
                        </div>
                    </div>`;
                card.addEventListener('click', () => handleCardClick(card));
                board.appendChild(card);
            });

            // Preview Phase
            const allCards = board.querySelectorAll('.memory-card');
            allCards.forEach(c => c.classList.add('preview'));
            setTimeout(() => {
                allCards.forEach(c => c.classList.remove('preview'));
                canClick = true;
                instructionEl.textContent = "Cocokkan kata dengan artinya!";
            }, 5000); // 5 detik

            function handleCardClick(card) {
                if (!canClick || flippedCards.length >= 2 || card.classList.contains('flipped')) return;
                card.classList.add('flipped');
                flippedCards.push(card);
                if (flippedCards.length === 2) checkMemoryMatch();
            }

            function checkMemoryMatch() {
                const [card1, card2] = flippedCards;
                if (card1.dataset.pairId === card2.dataset.pairId) {
                    feedbackEl.textContent = 'Cocok!';
                    feedbackEl.style.color = '#be185d';
                    matchedPairs++;
                    flippedCards = [];
                    if (matchedPairs === pairs.length) {
                        feedbackEl.textContent = 'Luar biasa! Semua cocok!';
                    }
                } else {
                    feedbackEl.textContent = 'Bukan pasangannya!';
                    feedbackEl.style.color = '#DC2626';
                    setTimeout(() => {
                        card1.classList.remove('flipped');
                        card2.classList.remove('flipped');
                        flippedCards = [];
                        feedbackEl.textContent = '';
                    }, 1200);
                }
            }
        }

        // --- GAME 10: TIC TAC TOE LOGIC ---
        function setupTicTacToeGame(container) {
            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-teal-800 mb-4">Tic Tac Toe Kosa Kata</h3>
                <div class="max-w-xs mx-auto bg-white p-4 rounded-lg shadow-inner">
                    <div id="ttt-status-message" class="text-xl font-semibold text-center text-blue-600 mb-4">
                        Giliran Pemain X
                    </div>
                    <div id="ttt-board" class="grid grid-cols-3 gap-3 bg-gray-200 p-3 rounded-lg shadow-inner">
                    </div>
                    <button id="ttt-reset-button" class="w-full mt-6 bg-red-500 text-white py-3 px-6 rounded-lg text-lg font-semibold shadow-md hover:bg-red-600 transition">
                        Ulangi Permainan
                    </button>
                </div>
            `;
            initTicTacToeGame();
        }
        function initTicTacToeGame() {
            tttGameLogic.dom.boardElement = document.getElementById('ttt-board');
            tttGameLogic.dom.statusMessage = document.getElementById('ttt-status-message');
            tttGameLogic.dom.resetButton = document.getElementById('ttt-reset-button');
            tttGameLogic.dom.questionModal = document.getElementById('ttt-question-modal');
            tttGameLogic.dom.questionBox = document.getElementById('ttt-question-box');
            tttGameLogic.dom.vocabWordElement = document.getElementById('ttt-vocab-word');
            tttGameLogic.dom.optionsContainer = document.getElementById('ttt-options-container');
            tttGameLogic.dom.resultMessage = document.getElementById('ttt-result-message');
            tttGameLogic.dom.timerDisplay = document.getElementById('ttt-timer-display');
            tttGameLogic.player = 'X';
            tttGameLogic.board = Array(9).fill('');
            tttGameLogic.active = true;
            tttGameLogic.targetIndex = null;
            if (tttGameLogic.timer) clearInterval(tttGameLogic.timer);
            tttGameLogic.dom.statusMessage.textContent = `Giliran Pemain ${tttGameLogic.player}`;
            tttGameLogic.dom.resultMessage.textContent = '';
            tttGameLogic.dom.timerDisplay.textContent = '';
            tttGameLogic.dom.boardElement.innerHTML = '';
            if (tttGameLogic.questions.length === 0) {
                tttGameLogic.questions = [...ticTacToeData].sort(() => 0.5 - Math.random());
            }
            tttGameLogic.board.forEach((_, index) => {
                const cell = document.createElement('div');
                cell.className = 'ttt-cell w-full h-20 md:h-24 bg-white rounded-lg flex items-center justify-center text-5xl md:text-6xl font-bold cursor-pointer transition duration-300 hover:bg-gray-50';
                cell.dataset.index = index;
                cell.addEventListener('click', handleTicTacToeCellClick);
                tttGameLogic.dom.boardElement.appendChild(cell);
            });
            const oldResetButton = tttGameLogic.dom.resetButton;
            const newResetButton = oldResetButton.cloneNode(true);
            oldResetButton.parentNode.replaceChild(newResetButton, oldResetButton);
            newResetButton.addEventListener('click', initTicTacToeGame);
            tttGameLogic.dom.resetButton = newResetButton;
            hideTicTacToeQuestionModal();
        }
        const tttWinPatterns = [
            [0, 1, 2], [3, 4, 5], [6, 7, 8],
            [0, 3, 6], [1, 4, 7], [2, 5, 8],
            [0, 4, 8], [2, 4, 6]
        ];
        function handleTicTacToeCellClick(event) {
            const clickedCellIndex = parseInt(event.target.dataset.index);
            if (tttGameLogic.board[clickedCellIndex] !== '' || !tttGameLogic.active) {
                return;
            }
            tttGameLogic.targetIndex = clickedCellIndex;
            showTicTacToeQuestion();
        }
        function showTicTacToeQuestion() {
            if (tttGameLogic.questions.length === 0) {
                tttGameLogic.questions = [...ticTacToeData].sort(() => 0.5 - Math.random());
            }
            const currentQuestion = tttGameLogic.questions.pop();
            const dom = tttGameLogic.dom;
            dom.questionModal.dataset.correctIndex = currentQuestion.correct;
            dom.vocabWordElement.textContent = currentQuestion.word;
            dom.optionsContainer.innerHTML = '';
            currentQuestion.options.forEach((option, index) => {
                const optionButton = document.createElement('button');
                optionButton.className = 'game-button w-full p-3 rounded-lg text-lg font-medium text-white bg-blue-500 hover:bg-blue-600 transition duration-200';
                optionButton.textContent = option;
                optionButton.dataset.index = index;
                optionButton.addEventListener('click', handleTicTacToeOptionClick);
                dom.optionsContainer.appendChild(optionButton);
            });
            if (tttGameLogic.timer) clearInterval(tttGameLogic.timer);
            let timeLeft = 10;
            dom.timerDisplay.textContent = timeLeft;
            dom.timerDisplay.classList.remove('text-gray-500');
            dom.timerDisplay.classList.add('text-red-500');
            tttGameLogic.timer = setInterval(() => {
                timeLeft--;
                dom.timerDisplay.textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(tttGameLogic.timer);
                    handleTicTacToeTimeout();
                }
            }, 1000);
            dom.questionModal.style.display = 'flex';
        }
        function hideTicTacToeQuestionModal() {
            if (tttGameLogic.timer) clearInterval(tttGameLogic.timer);
            const dom = tttGameLogic.dom;
            if(dom.timerDisplay) dom.timerDisplay.textContent = '';
            if(dom.questionModal) dom.questionModal.style.display = 'none';
            if(dom.resultMessage) dom.resultMessage.textContent = '';
        }
        function handleTicTacToeOptionClick(event) {
            clearInterval(tttGameLogic.timer);
            const dom = tttGameLogic.dom;
            dom.timerDisplay.classList.add('text-gray-500');
            const selectedIndex = parseInt(event.target.dataset.index);
            const correctIndex = parseInt(dom.questionModal.dataset.correctIndex);
            if (selectedIndex === correctIndex) {
                dom.resultMessage.textContent = 'Benar! (Correct!)';
                dom.resultMessage.style.color = '#16A34A';
                setTimeout(() => {
                    placeTicTacToeMark(tttGameLogic.targetIndex);
                    hideTicTacToeQuestionModal();
                }, 800);
            } else {
                dom.resultMessage.textContent = 'Salah! (Incorrect!) Giliran lawan.';
                dom.resultMessage.style.color = '#DC2626';
                setTimeout(() => {
                    changeTicTacToePlayer();
                    hideTicTacToeQuestionModal();
                }, 1200);
            }
        }
        function handleTicTacToeTimeout() {
            const dom = tttGameLogic.dom;
            dom.resultMessage.textContent = 'Waktu Habis! Giliran lawan.';
            dom.resultMessage.style.color = '#DC2626';
            setTimeout(() => {
                changeTicTacToePlayer();
                hideTicTacToeQuestionModal();
            }, 1200);
        }
        function placeTicTacToeMark(cellIndex) {
            if (!tttGameLogic.active || tttGameLogic.board[cellIndex] !== '') return;
            const dom = tttGameLogic.dom;
            tttGameLogic.board[cellIndex] = tttGameLogic.player;
            const cellElement = dom.boardElement.children[cellIndex];
            cellElement.textContent = tttGameLogic.player;
            cellElement.classList.add('filled');
            cellElement.classList.add(tttGameLogic.player === 'X' ? 'text-blue-600' : 'text-pink-500');
            if (checkTicTacToeWin()) {
                endTicTacToeGame(false);
            } else if (checkTicTacToeDraw()) {
                endTicTacToeGame(true);
            } else {
                changeTicTacToePlayer();
            }
        }
        function changeTicTacToePlayer() {
            tttGameLogic.player = tttGameLogic.player === 'X' ? 'O' : 'X';
            tttGameLogic.dom.statusMessage.textContent = `Giliran Pemain ${tttGameLogic.player}`;
        }
        function checkTicTacToeWin() {
            return tttWinPatterns.some(pattern => {
                return pattern.every(index => tttGameLogic.board[index] === tttGameLogic.player);
            });
        }
        function checkTicTacToeDraw() {
            return tttGameLogic.board.every(cell => cell !== '');
        }
        function endTicTacToeGame(isDraw) {
            tttGameLogic.active = false;
            const dom = tttGameLogic.dom;
            if (isDraw) {
                dom.statusMessage.textContent = 'Permainan Seri!';
                dom.statusMessage.classList.add('text-gray-700');
            } else {
                dom.statusMessage.textContent = `Pemain ${tttGameLogic.player} Menang!`;
                dom.statusMessage.classList.add('text-green-600');
            }
        }
        // --- AKHIR GAME 10 ---

        // --- (BARU) GAME 11: TEBAK KATA BERKELOMPOK ---

        // Layar 1: Papan Skor
        function setupGroupGuessGame(container) {
            // Pastikan timer sebelumnya bersih
            if (groupGameTimer) clearInterval(groupGameTimer);

            const timAText = `Tim A: ${groupGameScores.timA}`;
            const timBText = `Tim B: ${groupGameScores.timB}`;
            const giliranText = `Putaran ${currentRound}. Giliran untuk ${currentTurn === 'timA' ? 'TIM A' : 'TIM B'}.`;

            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-lime-800 mb-6">Tebak Kata Berkelompok</h3>
                <div class="text-center bg-gray-100 p-6 rounded-lg shadow-inner">
                    <h4 class="text-3xl font-bold text-blue-600">${timAText}</h4>
                    <h4 class="text-3xl font-bold text-red-600 mt-2">${timBText}</h4>
                </div>
                <p class="text-xl text-center font-semibold my-6">${giliranText}</p>
                <button onclick="showTurnInstructions()" class="game-button w-full text-xl bg-lime-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-lime-600">
                    Siap Main!
                </button>
            `;
        }

        // Layar 2: Instruksi
        function showTurnInstructions() {
            const gameContent = document.getElementById('game-content');
            const timText = currentTurn === 'timA' ? 'TIM A' : 'TIM B';

            gameContent.innerHTML = `
                <h3 class="text-3xl font-bold text-center text-lime-800 mb-4">Sekarang Giliran ${timText}!</h3>
                <div class="bg-blue-50 p-4 rounded-lg text-lg">
                    <p class="font-semibold">Instruksi:</p>
                    <p class="mt-2">1. Berikan HP ini kepada 1 orang yang akan menjadi "Pemberi Petunjuk".</p>
                    <p>2. Rekan satu tim lainnya menjadi "Penebak".</p>
                    <p class="font-semibold text-red-600 mt-4">Aturan: Pemberi Petunjuk DILARANG menyebutkan kata yang ada di layar atau artinya.</p>
                </div>
                <button onclick="startPlayingScreen()" class="game-button w-full text-xl mt-6 bg-green-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-600">
                    Mulai
                </button>
            `;
        }

        // Layar 3: Bermain
        function startPlayingScreen() {
            let roundScore = 0;
            let timeLeft = 60;
            // Acak tumpukan kartu untuk putaran ini
            groupGameShuffledDeck = [...guessGroupData].sort(() => 0.5 - Math.random());
            
            const gameContent = document.getElementById('game-content');
            gameContent.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <div id="group-timer" class="text-3xl font-bold text-red-500">01:00</div>
                    <div id="group-round-score" class="text-2xl font-semibold text-lime-800">Skor: 0</div>
                </div>
                <div class="bg-gray-100 rounded-xl shadow-lg p-8 h-48 flex flex-col justify-center items-center text-center">
                    <div id="group-word-arabic" class="arabic text-5xl font-bold text-gray-900">...</div>
                    <div id="group-word-meaning" class="text-2xl font-medium text-gray-700 mt-2">...</div>
                </div>
                <div class="grid grid-cols-2 gap-4 mt-6">
                    <button id="group-skip-btn" class="game-button text-xl bg-gray-400 text-white font-bold py-4 px-6 rounded-lg hover:bg-gray-500">
                        LEWATI
                    </button>
                    <button id="group-correct-btn" class="game-button text-xl bg-green-500 text-white font-bold py-4 px-6 rounded-lg hover:bg-green-600">
                        BENAR
                    </button>
                </div>
            `;

            // Cache DOM Layar 3
            const timerEl = document.getElementById('group-timer');
            const scoreEl = document.getElementById('group-round-score');
            const wordEl = document.getElementById('group-word-arabic');
            const meaningEl = document.getElementById('group-word-meaning');
            const skipBtn = document.getElementById('group-skip-btn');
            const correctBtn = document.getElementById('group-correct-btn');

            function showNextWord() {
                if (groupGameShuffledDeck.length === 0) {
                    // Jika kata habis, anggap waktu habis
                    if (groupGameTimer) clearInterval(groupGameTimer);
                    groupGameScores[currentTurn] += roundScore;
                    showTurnEndScreen(roundScore);
                    return;
                }
                const card = groupGameShuffledDeck.pop();
                wordEl.textContent = card.word;
                meaningEl.textContent = card.meaning;
            }

            // Atur tombol
            correctBtn.onclick = () => {
                roundScore++;
                scoreEl.textContent = `Skor: ${roundScore}`;
                showNextWord();
            };
            skipBtn.onclick = () => {
                showNextWord();
            };

            // Mulai Timer
            if (groupGameTimer) clearInterval(groupGameTimer);
            groupGameTimer = setInterval(() => {
                timeLeft--;
                timerEl.textContent = `00:${timeLeft < 10 ? '0' : ''}${timeLeft}`;
                
                if (timeLeft <= 0) {
                    clearInterval(groupGameTimer);
                    groupGameScores[currentTurn] += roundScore;
                    showTurnEndScreen(roundScore);
                }
            }, 1000);

            // Tampilkan kata pertama
            showNextWord();
        }

        // Layar 4: Giliran Selesai
        function showTurnEndScreen(score) {
            const gameContent = document.getElementById('game-content');
            const timText = currentTurn === 'timA' ? 'Tim A' : 'TIM B';
            const nextTimText = currentTurn === 'timA' ? 'Tim B' : 'Tim A';

            gameContent.innerHTML = `
                <h3 class="text-3xl font-bold text-center text-red-500 mb-4">Waktu Habis!</h3>
                <p class="text-xl text-center mb-6">${timText} berhasil menebak <strong>${score}</strong> kata!</p>
                <button onclick="handleNextTurn()" class="game-button w-full text-xl bg-blue-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-600">
                    Lanjut ke Giliran ${nextTimText}
                </button>
            `;
        }

        // Logika Transisi
        function handleNextTurn() {
            if (currentTurn === 'timA') {
                // Tim A baru selesai, sekarang giliran Tim B
                currentTurn = 'timB';
                showTurnInstructions(); // Kembali ke Layar 2 (Instruksi)
            } else {
                // Tim B baru selesai, putaran berakhir
                currentTurn = 'timA';
                currentRound++;
                // Ambil game-content lagi dan panggil Layar 1 (Papan Skor)
                const gameContent = document.getElementById('game-content');
                setupGroupGuessGame(gameContent); 
            }
        }
        // --- AKHIR GAME 11 ---

        // --- (BARU) GAME 12: PUKUL KATA (WHACK-A-MOLE) ---
        
        function setupWhackAMoleGame(container) {
            wamScore = 0;
            wamTimeLeft = 30;
            wamIsPlaying = false;
            lastHole = null;

            container.innerHTML = `
                <h3 class="text-2xl font-bold text-center text-rose-800 mb-4">Pukul Kata (Refleks)</h3>
                <div class="flex justify-between items-center mb-4 px-4">
                    <div class="text-xl font-bold text-blue-700">Target: <span id="wam-target" class="text-rose-600">...</span></div>
                    <div class="text-xl font-bold text-green-700">Skor: <span id="wam-score">0</span></div>
                    <div class="text-xl font-bold text-red-500">Waktu: <span id="wam-timer">30</span>s</div>
                </div>
                
                <div class="grid grid-cols-3 gap-4 max-w-sm mx-auto mb-6">
                    <!-- 9 Lubang -->
                    ${Array(9).fill(0).map((_, i) => `
                        <div class="mole-hole h-24 md:h-28">
                            <div class="mole text-2xl md:text-3xl arabic" id="hole-${i}" onclick="bonk(event)"></div>
                        </div>
                    `).join('')}
                </div>

                <div class="text-center">
                    <button id="wam-start-btn" onclick="startWhackAMole()" class="game-button bg-rose-500 text-white font-bold py-3 px-8 rounded-lg text-xl hover:bg-rose-600 shadow-lg transform transition hover:scale-105">
                        MULAI
                    </button>
                </div>
            `;
        }

        function randomTime(min, max) {
            return Math.round(Math.random() * (max - min) + min);
        }

        function randomHole(holes) {
            const idx = Math.floor(Math.random() * holes.length);
            const hole = holes[idx];
            if (hole === lastHole) return randomHole(holes);
            lastHole = hole;
            return hole;
        }

        function peep() {
            if (!wamIsPlaying) return;
            
            const holes = document.querySelectorAll('.mole'); // Sebenarnya ini elemen mole-nya
            const hole = randomHole(holes);
            
            // Tentukan kata yang muncul
            // 40% peluang muncul kata target yang benar
            // 60% peluang muncul kata pengcoh
            const isTarget = Math.random() < 0.4;
            let wordToShow;
            
            if (isTarget) {
                wordToShow = wamTarget.arabic;
                hole.dataset.isTarget = "true";
            } else {
                // Cari pengcoh (kata selain target)
                let distractor = guessGroupData[Math.floor(Math.random() * guessGroupData.length)];
                while (distractor.word === wamTarget.word) {
                    distractor = guessGroupData[Math.floor(Math.random() * guessGroupData.length)];
                }
                wordToShow = distractor.word; // word di sini adalah arabic text dari guessGroupData
                hole.dataset.isTarget = "false";
            }

            hole.textContent = wordToShow;
            hole.classList.remove('hit', 'wrong'); // Reset status visual
            hole.classList.add('up');

            // Kecepatan muncul (makin lama makin cepat bisa diatur, tapi random 600-1000ms cukup)
            const time = randomTime(700, 1200); 
            
            setTimeout(() => {
                hole.classList.remove('up');
                if (wamIsPlaying) peep();
            }, time);
        }

        function startWhackAMole() {
            // Reset UI
            const startBtn = document.getElementById('wam-start-btn');
            if (startBtn) startBtn.style.display = 'none';
            
            wamScore = 0;
            wamTimeLeft = 30;
            document.getElementById('wam-score').textContent = wamScore;
            document.getElementById('wam-timer').textContent = wamTimeLeft;
            
            // Pilih Target Baru
            const randomItem = guessGroupData[Math.floor(Math.random() * guessGroupData.length)];
            // Format data guessGroupData: { word: "...", meaning: "..." }
            // Kita sesuaikan strukturnya
            wamTarget = { arabic: randomItem.word, meaning: randomItem.meaning };
            document.getElementById('wam-target').textContent = wamTarget.meaning.toUpperCase();

            wamIsPlaying = true;
            
            // Mulai Loop Muncul
            peep();

            // Mulai Timer Game
            wamTimer = setInterval(() => {
                wamTimeLeft--;
                const timerEl = document.getElementById('wam-timer');
                if (timerEl) timerEl.textContent = wamTimeLeft;
                
                if (wamTimeLeft <= 0) {
                    stopWhackAMoleGame();
                }
            }, 1000);
        }

        function stopWhackAMoleGame() {
            wamIsPlaying = false;
            clearInterval(wamTimer);
            
            // Bersihkan semua mole yang masih up
            const moles = document.querySelectorAll('.mole');
            moles.forEach(mole => mole.classList.remove('up'));

            const startBtn = document.getElementById('wam-start-btn');
            if (startBtn) {
                startBtn.style.display = 'inline-block';
                startBtn.textContent = 'MAIN LAGI';
            }
            
            // Tampilkan pesan akhir jika waktu habis (bukan karena pindah menu)
            const container = document.getElementById('game-container');
            // Cek apakah masih di halaman game ini
            if (!container.classList.contains('hidden') && wamTimeLeft <= 0) {
                 alert(`Waktu Habis! Skor Akhirmu: ${wamScore}`);
            }
        }

        function bonk(e) {
            if (!e.isTrusted) return; // anti-cheat script
            if (!wamIsPlaying) return;

            const mole = e.target;
            
            // Cek apakah ini target yang benar
            if (mole.dataset.isTarget === "true") {
                wamScore += 10;
                mole.classList.add('hit');
                // Ganti target setelah berhasil? Atau tetap sama? 
                // Biar seru, target tetap sama satu ronde, atau bisa ganti. 
                // Untuk kesederhanaan, target tetap sama sampai game over.
            } else {
                wamScore = Math.max(0, wamScore - 5); // Skor tidak boleh minus
                mole.classList.add('wrong');
            }
            
            mole.classList.remove('up');
            document.getElementById('wam-score').textContent = wamScore;
        }
        // --- AKHIR GAME 12 ---

    </script>
</body>
</html>
